package com.xy.springboot.service.impl;

import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
import com.xy.springboot.model.entity.Vulnerability;
import com.xy.springboot.service.VulnerabilityService;
import com.xy.springboot.mapper.VulnerabilityMapper;
import org.springframework.stereotype.Service;

import java.util.Objects;

/**
* @author XY
* @description 针对表【vulnerability(Vulnerability参数配置)】的数据库操作Service实现
* @createDate 2024-07-01 21:59:23
*/
@Service
public class VulnerabilityServiceImpl extends ServiceImpl<VulnerabilityMapper, Vulnerability>
    implements VulnerabilityService{
    @Override
    public int createOrUpdateVulnerability(Vulnerability vulnerability){
        QueryWrapper<Vulnerability> queryWrapper = new QueryWrapper<>();
        queryWrapper.eq("taskId", vulnerability.getTaskId());
        Vulnerability vulnerabilityExist = this.getOne(queryWrapper);
        if (Objects.isNull(vulnerabilityExist)) {
            return this.baseMapper.insert(vulnerability);
        } else {
            vulnerability.setId(vulnerabilityExist.getId());
            return this.baseMapper.updateById(vulnerability);
        }
    }

    @Override
    public Vulnerability getVulnerabilityByTaskId(Long taskId){
        QueryWrapper<Vulnerability> queryWrapper = new QueryWrapper<>();
        queryWrapper.eq("taskId", taskId);
        return this.getOne(queryWrapper);
    }
}




